#!/usr/bin/make -f

DEB_PYTHON_SYSTEM := pysupport

include /usr/share/cdbs/1/rules/buildcore.mk
include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/python-distutils.mk
include /usr/share/cdbs/1/rules/simple-patchsys.mk

binary-post-install/python-django-gis::
	# Use default python shebang
	perl -pi -e 's|^#!/usr/bin/env python.*$$|#!/usr/bin/python|' debian/python-django-gis/usr/share/python-support/python-django-gis/django/conf/project_template/manage.py
	# Ensure executability of some scripts that are copied to projects
	# (or used within projects)
	chmod 755 debian/python-django-gis/usr/share/python-support/python-django-gis/django/conf/project_template/manage.py
	chmod 755 debian/python-django-gis/usr/share/python-support/python-django-gis/django/bin/[^_]*.py
	chmod 755 debian/python-django-gis/usr/share/python-support/python-django-gis/django/bin/profiling/[^_]*.py
	# Create convenience symlink
	mkdir -p debian/python-django-gis/usr/lib/python-django-gis
	dh_link usr/share/python-support/python-django-gis/django/bin usr/lib/python-django-gis/bin 
	# Rename django-admin.py to django-admin
	mv debian/python-django-gis/usr/bin/django-admin.py debian/python-django-gis/usr/bin/django-admin
